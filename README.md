# BI_report_HR  
Приложение для HR состоящее из дашбордов в Power BI  
Предыстория:  
ко мне обратилась руководитель HR отдела для разработки небольшого автоматизированного отчета в BI. До этого основные показатели (текучесть, вовлеченность и др.) рассчитывались в табличках Excel полу ручным способом.  
Так выглядели отчеты в Excel файлах:   
 
 <img width="1301" height="711" alt="1" src="https://github.com/user-attachments/assets/bdec0cbe-0bd6-40c1-90e9-10bedeed422c" />

Причину автоматизации мне объяснили тем, что около 4-х часов в неделю сотрудник HR отдела тратил на расчет показателей в таблицах Excel. (Что хорошо – видно, что какими-то графиками и диаграммами уже пользовались).  
**Сбор требований к отчету:**  
После первой встречи с HR отделом в лице руководителя, специалиста, занимавшегося сбором данных и оформлением отчетов в таблицах Excel, выяснилось, что источники с необходимыми данными находятся в регулярных выгрузках из 1С Предприятие, Google Sheets, Битрикс24, PostgreSQL, iSpring. По визуальному оформлению как таковых «жестких» требований не было, была лишь просьба, учесть наглядность представляемых данных и «желательно как в таблицах Excel». 
**Работа над дашбордом:**  
Задача показалась мне интересной ввиду достаточно большого количества разнообразных источников данных и свободы в выборе визуализации данных.  
Для прозрачности работы, контроля текущего статуса над задачей и внесение своевременных правок в оформление и расчет метрик решили собираться раз в неделю по четвергам (этот день назвали «День HR»). 
Для всех источников данных решил использовать БД PostgreSQL (была развернута в компании). Для разработки ETL-процессов — Apache Airflow.  
Ниже представлена схема ETL процесса:  
<img width="1403" height="641" alt="3" src="https://github.com/user-attachments/assets/8c6fbd88-fcb1-41b3-affb-1b224e6dee1e" />
Данные раз в сутки (по расписанию) загружаю:  
- с помощью API REST с опросников (google sheets),  
- с помощью API REST с платформы для обучения сотрудников iSpring,  
- с Битрикс24 веб-скрейпингом (у Битрикс24 есть за дополнительную плату расширение BI-Аналитика, но в компании бесплатная версия, поэтому получение данных организовано таким образом),  
- с сетевых папок, в которых хранятся регулярные выгрузки в формате .xlsx из 1С.  
Пример DAG (таблица с курсами iSpring) в файле *DAG_iSpring.py*


